<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <meta name="Description" content="An event-driven networking engine written in Python and MIT licensed." />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extending the Lore Documentation System &mdash; Twisted 14.0.2 documentation</title>
    <link rel="stylesheet" href="../../_static/twistedtrac.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '14.0.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Twisted 14.0.2 documentation" href="../../index.html" />
    <link rel="up" title="Developer Guides" href="index.html" />
    <link rel="next" title="Examples" href="../examples/index.html" />
    <link rel="prev" title="Using the Lore Documentation System" href="lore.html" /> 
    
<!-- Can stuff between these comments go? -->
        <link rel="search" href="/trac/search" />
        <link rel="help" href="/trac/wiki/TracGuide" />
        <link rel="alternate" href="/trac/wiki/Documentation?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="/trac/wiki" />

        
    <script type="text/javascript" src="/trac/chrome/common/js/jquery.js"></script><script type="text/javascript" src="/trac/chrome/common/js/trac.js"></script><script type="text/javascript" src="/trac/chrome/common/js/search.js"></script>
    
    <!-- the following script tag is a holdover frome Trac, which shouldn't be needed in Sphinx
    <script type="text/javascript">
      $(document).ready(function() {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor("Link to this section");
      });
    </script>
    -->
<!-- Can stuff between these comments go? -->

  </head>
  
  
<body>

<div id="banner">
<div id="top_grad">
         
</div>
<div id="tab">
        <a href="http://twistedmatrix.com/trac/wiki">HOME</a>
    <a href="http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions">FAQ</a>
    <a href="/">DOCS</a>
    <a href="http://twistedmatrix.com/trac/wiki/Downloads">DOWNLOAD</a>

</div>
      <div id="header">
        <a id="logo" href="http://twistedmatrix.com/trac/"><img src="../../_static/trac_banner.png" alt="Twisted" /></a>
      </div>
      <!-- taking this out for now, but might use 
           the space for something else later 
      -->
      <!--
      <form id="topsearch" action="/trac/search" method="get"><div>
        <label for="proj-search">Search:</label>
        <input type="text" id="proj-search" name="q" size="10" value="" />
        <input type="submit" value="Search" />
        <input type="hidden" name="wiki" value="on" />

        <input type="hidden" name="changeset" value="on" />
        <input type="hidden" name="ticket" value="on" />
      </div></form>
      -->
      <div id="metanav" class="nav">
    <ul>
      <li> </li>
      <!-- taking this out for now, but might use 
           the space for something else later 
      -->
      <!--
      <li class="first">logged in as khorn</li><li class=""><a href="/trac/logout">Logout</a></li><li class=""><a href="/trac/wiki/TracGuide">Help/Guide</a></li><li class=""><a href="/trac/about">About Trac</a></li><li class="last"><a href="/trac/account">My Account</a></li>
      -->
    </ul>
  </div>
    </div>

<!-- mainnav -->
    <div id="mainnav" class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../examples/index.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lore.html" title="Using the Lore Documentation System"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Twisted 14.0.2 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Twisted Lore</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Developer Guides</a> &raquo;</li> 
      </ul>
    </div>

    <div id="main">
    <div id="ctxtnav" class="nav">
      <h2>Wiki Navigation</h2>
      <ul>
        <li>
        
        </li>
        <!-- taking this out for now, but might use 
             the space for something else later 
        -->
        <!--
        <li><a href="/trac/wiki/WikiStart">Start Page</a></li>
        <li><a href="/trac/wiki/TitleIndex">Index by Title</a></li>

        <li><a href="/trac/wiki/RecentChanges">Index by Date</a></li>
        <li class="last">
          <a href="/trac/wiki/Documentation?action=diff&amp;version=15">Last Change</a>
        </li>
        -->
      </ul>
      <hr />
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div id="current-docs-container" style="display: none">
            <em>
              <a id="current-docs-link">
                Go to the latest version of this document.
              </a>
            </em>
          </div>
          <div class="body">
            
  <div class="section" id="extending-the-lore-documentation-system">
<h1>Extending the Lore Documentation System<a class="headerlink" href="#extending-the-lore-documentation-system" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="lore.html"><em>Lore Documentation System</em></a> , out of the box, is
specialized for documenting Twisted.  Its markup includes CSS classes for
Python, HTML, filenames, and other Twisted-focused categories.  But don&#8217;t
think this means Lore can&#8217;t be used for other documentation tasks!  Lore is
designed to allow extensions, giving any Python programmer the ability to
customize Lore for documenting almost anything.</p>
<p>There are several reasons why you would want to extend Lore.  You may want
to attach file formats Lore does not understand to your documentation.  You
may want to create callouts that have special meanings to the reader, to give a
memorable appearance to text such as, &#8220;WARNING: This software was written by a frothing madman!&#8221; You may want to create color-coding for a different
programming language, or you may find that Lore does not provide you with
enough structure to mark your document up completely.  All of these situations
can be solved by creating an extension.</p>
</div>
<div class="section" id="inputs-and-outputs">
<h2>Inputs and Outputs<a class="headerlink" href="#inputs-and-outputs" title="Permalink to this headline">¶</a></h2>
<p>Lore works by reading the HTML source of your document, and
producing whatever output the user specifies on the command line.  If
the HTML document is well-formed XML that meets a certain minimum
standard, Lore will be able to to produce some output.  All Lore
extensions will be written to redefine the <em>input</em> , and most
will redefine the output in some way.  The name of the default input
is &#8220;lore&#8221; .  When you write your extension, you will come up with
a new name for your input, telling Lore what rules to use to process
the file.</p>
<p>Lore can produce XHTML, LaTeX, and DocBook document formats, which can be
displayed directly if you have a user agent capable of viewing them, or
processed into a third form such as PostScript or PDF.  Another output is
called &#8220;lint&#8221; , after the static-checking utility for C, and is used for
the same reason: to statically check input files for problems.  The&#8221;lint&#8221; output is just a stream of error messages, not a formatted
document, but is important because it gives users the ability to validate
their input before trying to process it.  For the first example, the only
output we will be concerned with is LaTeX.</p>
<div class="section" id="creating-new-inputs">
<h3>Creating New Inputs<a class="headerlink" href="#creating-new-inputs" title="Permalink to this headline">¶</a></h3>
<p>Create a new input to tell Lore that your document is marked up differently
from a vanilla Lore document.  This gives you the power to define a new tag
class, for example:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;p&gt;The Frabjulon &lt;span class=&quot;productname&quot;&gt;Limpet 2000&lt;/span&gt;
is the &lt;span class=&quot;marketinglie&quot;&gt;industry-leading&lt;/span&gt; aquatic
mollusc counter, bar none.&lt;/p&gt;
</pre></div>
</div>
<p>The above HTML is an instance of a new input to Lore, which we will call
MyHTML, to differentiate it from the &#8220;lore&#8221; input.  We want it to have
the following markup:</p>
<ul class="simple">
<li>A <tt class="docutils literal"><span class="pre">productname</span></tt> class for the &lt;span&gt; tag, which
produces underlined text</li>
<li>A <tt class="docutils literal"><span class="pre">marketinglie</span></tt> class for &lt;span&gt; tag, which
produces larger type, bold text</li>
</ul>
<p>Note that I chose class names that are valid Python identifiers.  You will
see why shortly.  To get these two effects in Lore&#8217;s HTML output, all we have
to do is create a cascading stylesheet (CSS), and use it in the Lore XHTML
Template.  However, we also want these effects to work in LaTeX, and we want
the output of lint to produce no warnings when it sees lines with these 2
classes.  To make LaTeX and lint work, we start by creating a plugin.</p>
<p><a class="reference download internal" href="../../_downloads/a_lore_plugin.py"><tt class="xref download docutils literal"><span class="pre">a_lore_plugin.py</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="kn">from</span> <span class="nn">twisted.plugin</span> <span class="kn">import</span> <span class="n">IPlugin</span>
<span class="kn">from</span> <span class="nn">twisted.lore.scripts.lore</span> <span class="kn">import</span> <span class="n">IProcessor</span>

<span class="k">class</span> <span class="nc">MyHTML</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">implements</span><span class="p">(</span><span class="n">IPlugin</span><span class="p">,</span> <span class="n">IProcessor</span><span class="p">)</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;myhtml&quot;</span>
    <span class="n">moduleName</span> <span class="o">=</span> <span class="s">&quot;myhtml.factory&quot;</span>
</pre></div>
</div>
<p>Create this file in a <tt class="docutils literal"><span class="pre">twisted/plugins/</span></tt>
directory (<em>not</em> a package) which is located in a directory in the
Python module search path.  See the <a class="reference internal" href="../../core/howto/plugin.html"><em>Twisted plugin howto</em></a> for more details on plugins.</p>
<p>Users of your extension will pass the value of your plugin&#8217;s <tt class="docutils literal"><span class="pre">name</span></tt> attribute to lore with the <tt class="docutils literal"><span class="pre">--input</span></tt> parameter on the command line to select it.  For
example, to select the plugin defined above, a user would pass <tt class="docutils literal"><span class="pre">--input</span> <span class="pre">myhtml</span></tt> .  The <tt class="docutils literal"><span class="pre">moduleName</span></tt> attribute tells Lore where to find the code
implementing the plugin.  In particular, this module should have a <tt class="docutils literal"><span class="pre">factory</span></tt> attribute which defines a <tt class="docutils literal"><span class="pre">generator_</span></tt> -prefixed method for each output format it
supports.  Next we&#8217;ll look at this module.</p>
<p><a class="reference download internal" href="../../_downloads/factory.py-1"><tt class="xref download docutils literal"><span class="pre">factory.py-1</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">twisted.lore</span> <span class="kn">import</span> <span class="n">default</span>
<span class="kn">from</span> <span class="nn">myhtml</span> <span class="kn">import</span> <span class="n">spitters</span>

<span class="k">class</span> <span class="nc">MyProcessingFunctionFactory</span><span class="p">(</span><span class="n">default</span><span class="o">.</span><span class="n">ProcessingFunctionFactory</span><span class="p">):</span>
    <span class="n">latexSpitters</span><span class="o">=</span><span class="p">{</span><span class="bp">None</span><span class="p">:</span> <span class="n">spitters</span><span class="o">.</span><span class="n">MyLatexSpitter</span><span class="p">,</span>
                   <span class="p">}</span>

<span class="c"># initialize the global variable factory with an instance of your new factory</span>
<span class="n">factory</span><span class="o">=</span><span class="n">MyProcessingFunctionFactory</span><span class="p">()</span>
</pre></div>
</div>
<p>In Listing 2, we create a subclass of ProcessingFunctionFactory.
This class provides a hook for you, a class variable
named <tt class="docutils literal"><span class="pre">latexSpitters</span></tt> .  This variable tells Lore what new
class will be generating LaTeX from your input format.  We
redefine <tt class="docutils literal"><span class="pre">latexSpitters</span></tt> to <tt class="docutils literal"><span class="pre">MyLatexSpitter</span></tt> in
the subclass because this class knows what to do with the new input we
have already defined.  Last, you must define the module-level
variable <tt class="docutils literal"><span class="pre">factory</span></tt> .  It should be
an instance with the same interface
as <tt class="docutils literal"><span class="pre">ProcessingFunctionFactory</span></tt>
(e.g. an instance of a subclass, in this
case, <tt class="docutils literal"><span class="pre">MyProcessingFunctionFactory</span></tt> ).</p>
<p>Now let&#8217;s actually write some code to generate the LaTeX.  Doing this
requires at least a familiarity with the LaTeX language.  Search Google for&#8221;latex tutorial&#8221; and you will find any number of useful LaTeX
resources.</p>
<p><a class="reference download internal" href="../../_downloads/spitters.py-1"><tt class="xref download docutils literal"><span class="pre">spitters.py-1</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">twisted.lore</span> <span class="kn">import</span> <span class="n">latex</span>
<span class="kn">from</span> <span class="nn">twisted.lore.latex</span> <span class="kn">import</span> <span class="n">processFile</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="k">class</span> <span class="nc">MyLatexSpitter</span><span class="p">(</span><span class="n">latex</span><span class="o">.</span><span class="n">LatexSpitter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visitNode_span_productname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="c"># start an underline section in LaTeX</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">underline{&#39;</span><span class="p">)</span>
        <span class="c"># process the node and its children</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visitNodeDefault</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> 
        <span class="c"># end the underline block</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;}&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visitNode_span_marketinglie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="c"># this example turns on more than one LaTeX effect at once</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">begin{bf}</span><span class="se">\\</span><span class="s">begin{Large}&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visitNodeDefault</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">end{Large}</span><span class="se">\\</span><span class="s">end{bf}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The method <tt class="docutils literal"><span class="pre">visitNode_span_productname</span></tt> is our handler
for &lt;span&gt; tags with the <tt class="docutils literal"><span class="pre">class=&quot;productname&quot;</span></tt>
identifier.  Lore knows to try methods <tt class="docutils literal"><span class="pre">visitNode_span_*</span></tt>
and <tt class="docutils literal"><span class="pre">visitNode_div_*</span></tt> whenever it encounters a new class in
one of these tags.  This is why the class names have to be valid
Python identifiers.</p>
<p>Now let&#8217;s see what Lore does with these new classes with the following
input file:</p>
<p><a class="reference download internal" href="../../_downloads/1st_example.html"><tt class="xref download docutils literal"><span class="pre">1st_example.html</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre>&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My First Example&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;My First Example&lt;/h1&gt;
    &lt;p&gt;The Frabjulon &lt;span class=&quot;productname&quot;&gt;Limpet 2000&lt;/span&gt;
    is the &lt;span class=&quot;marketinglie&quot;&gt;industry-leading&lt;/span&gt; aquatic 
    mollusc counter, bar none.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>First, verify that your package is laid out correctly.  Your directory
structure should look like this:</p>
<div class="highlight-python"><div class="highlight"><pre>1st_example.html
myhtml/
       __init__.py
       factory.py
       spitters.py
twisted/plugins/
       a_lore_plugin.py
</pre></div>
</div>
<p>In the parent directory of myhtml (that is, <tt class="docutils literal"><span class="pre">myhtml/..</span></tt> ), run
lore and pdflatex on the input:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> lore --input myhtml --output latex 1st_example.html
<span class="go">[########################################] (*Done*)</span>

<span class="gp">$</span> pdflatex 1st_example.tex
<span class="go">[ . . . latex output omitted for brevity . . . ]</span>
<span class="go">Output written on 1st_example.pdf (1 page, 22260 bytes).</span>
<span class="go">Transcript written on 1st_example.log.</span>
</pre></div>
</div>
<p>And here&#8217;s what the rendered PDF looks like:</p>
<img alt="../../_images/myhtml-output.png" src="../../_images/myhtml-output.png" />
<p>What happens when we run lore on this file using the lint output?</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> lore --input myhtml --output lint 1st_example.html
<span class="go">1st_example.html:7:47: unknown class productname</span>
<span class="go">1st_example.html:8:38: unknown class marketinglie</span>
<span class="go">[########################################] (*Done*)</span>
</pre></div>
</div>
<p>Lint reports these classes as errors, even though our spitter knows how to
process them.  To fix this problem, we must add to <tt class="docutils literal"><span class="pre">factory.py</span></tt> .</p>
<p><a class="reference download internal" href="../../_downloads/factory.py-2"><tt class="xref download docutils literal"><span class="pre">factory.py-2</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">twisted.lore</span> <span class="kn">import</span> <span class="n">default</span>
<span class="kn">from</span> <span class="nn">myhtml</span> <span class="kn">import</span> <span class="n">spitters</span>

<span class="k">class</span> <span class="nc">MyProcessingFunctionFactory</span><span class="p">(</span><span class="n">default</span><span class="o">.</span><span class="n">ProcessingFunctionFactory</span><span class="p">):</span>
    <span class="n">latexSpitters</span><span class="o">=</span><span class="p">{</span><span class="bp">None</span><span class="p">:</span> <span class="n">spitters</span><span class="o">.</span><span class="n">MyLatexSpitter</span><span class="p">,</span>
                   <span class="p">}</span>

    <span class="c"># redefine getLintChecker to validate our classes</span>
    <span class="k">def</span> <span class="nf">getLintChecker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># use the default checker from parent</span>
        <span class="n">checker</span> <span class="o">=</span> <span class="n">lint</span><span class="o">.</span><span class="n">getDefaultChecker</span><span class="p">()</span>
        <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span> <span class="o">=</span> <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">oldSpan</span> <span class="o">=</span> <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span><span class="p">[</span><span class="s">&#39;span&#39;</span><span class="p">]</span>
        <span class="n">checkfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">oldSpan</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cl</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;marketinglie&#39;</span><span class="p">,</span>
                                                   <span class="s">&#39;productname&#39;</span><span class="p">]</span>
        <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span><span class="p">[</span><span class="s">&#39;span&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkfunc</span>
        <span class="k">return</span> <span class="n">checker</span>

<span class="c"># initialize the global variable factory with an instance of your new factory</span>
<span class="n">factory</span><span class="o">=</span><span class="n">MyProcessingFunctionFactory</span><span class="p">()</span>
</pre></div>
</div>
<p>The method <tt class="docutils literal"><span class="pre">getLintChecker</span></tt> is called
by Lore to produce the lint output.  This modification adds our classes to the
list of classes lint ignores:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> lore --input myhtml --output lint 1st_example.html
<span class="go">[########################################] (*Done*)</span>
<span class="gp">$</span> <span class="c"># Hooray!</span>
</pre></div>
</div>
<p>Finally, there are two other sub-outputs of LaTeX, for a total of three
different ways that Lore can produce LaTeX: the default way, which produces as
output an entire, self-contained LaTeX document; with <tt class="docutils literal"><span class="pre">--config</span> <span class="pre">section</span></tt> on the command line, which produces a
LaTeX section; and with <tt class="docutils literal"><span class="pre">--config</span> <span class="pre">chapter</span></tt> , which
produces a LaTeX chapter.  To support these options as well, the solution is
to make the new spitter class a mixin, and use it with the <tt class="docutils literal"><span class="pre">SectionLatexSpitter</span></tt> and <tt class="docutils literal"><span class="pre">ChapterLatexSpitter</span></tt> , respectively.
Comments in the following listings tell you everything you need to know about
making these simple changes:</p>
<ul>
<li><p class="first"><a class="reference download internal" href="../../_downloads/factory.py-3"><tt class="xref download docutils literal"><span class="pre">factory.py-3</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">twisted.lore</span> <span class="kn">import</span> <span class="n">default</span>
<span class="kn">from</span> <span class="nn">myhtml</span> <span class="kn">import</span> <span class="n">spitters</span>

<span class="k">class</span> <span class="nc">MyProcessingFunctionFactory</span><span class="p">(</span><span class="n">default</span><span class="o">.</span><span class="n">ProcessingFunctionFactory</span><span class="p">):</span>
    <span class="c"># 1. add the keys &quot;chapter&quot; and &quot;section&quot; to latexSpitters to handle the</span>
    <span class="c"># --config chapter and --config section options</span>
    <span class="n">latexSpitters</span><span class="o">=</span><span class="p">{</span><span class="bp">None</span><span class="p">:</span> <span class="n">spitters</span><span class="o">.</span><span class="n">MyLatexSpitter</span><span class="p">,</span>
                   <span class="s">&quot;section&quot;</span><span class="p">:</span> <span class="n">spitters</span><span class="o">.</span><span class="n">MySectionLatexSpitter</span><span class="p">,</span>
                   <span class="s">&quot;chapter&quot;</span><span class="p">:</span> <span class="n">spitters</span><span class="o">.</span><span class="n">MyChapterLatexSpitter</span><span class="p">,</span>
                   <span class="p">}</span>

    <span class="k">def</span> <span class="nf">getLintChecker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">checker</span> <span class="o">=</span> <span class="n">lint</span><span class="o">.</span><span class="n">getDefaultChecker</span><span class="p">()</span>
        <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span> <span class="o">=</span> <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">oldSpan</span> <span class="o">=</span> <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span><span class="p">[</span><span class="s">&#39;span&#39;</span><span class="p">]</span>
        <span class="n">checkfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cl</span><span class="p">:</span> <span class="n">oldSpan</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cl</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;marketinglie&#39;</span><span class="p">,</span>
                                                   <span class="s">&#39;productname&#39;</span><span class="p">]</span>
        <span class="n">checker</span><span class="o">.</span><span class="n">allowedClasses</span><span class="p">[</span><span class="s">&#39;span&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkfunc</span>
        <span class="k">return</span> <span class="n">checker</span>

<span class="n">factory</span><span class="o">=</span><span class="n">MyProcessingFunctionFactory</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference download internal" href="../../_downloads/spitters.py-2"><tt class="xref download docutils literal"><span class="pre">spitters.py-2</span></tt></a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">twisted.lore</span> <span class="kn">import</span> <span class="n">latex</span>
<span class="kn">from</span> <span class="nn">twisted.lore.latex</span> <span class="kn">import</span> <span class="n">processFile</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="c"># 2. Create a new mixin that does what the old MyLatexSpitter used to do:</span>
<span class="c"># process the new classes we defined</span>
<span class="k">class</span> <span class="nc">MySpitterMixin</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">visitNode_span_productname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">underline{&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visitNodeDefault</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;}&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visitNode_span_marketinglie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">begin{bf}</span><span class="se">\\</span><span class="s">begin{Large}&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visitNodeDefault</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">end{Large}</span><span class="se">\\</span><span class="s">end{bf}&#39;</span><span class="p">)</span>

<span class="c"># 3. inherit from the mixin class for each of the three sub-spitters</span>
<span class="k">class</span> <span class="nc">MyLatexSpitter</span><span class="p">(</span><span class="n">MySpitterMixin</span><span class="p">,</span> <span class="n">latex</span><span class="o">.</span><span class="n">LatexSpitter</span><span class="p">):</span>
    <span class="k">pass</span>
    
<span class="k">class</span> <span class="nc">MySectionLatexSpitter</span><span class="p">(</span><span class="n">MySpitterMixin</span><span class="p">,</span> <span class="n">latex</span><span class="o">.</span><span class="n">SectionLatexSpitter</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">MyChapterLatexSpitter</span><span class="p">(</span><span class="n">MySpitterMixin</span><span class="p">,</span> <span class="n">latex</span><span class="o">.</span><span class="n">ChapterLatexSpitter</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Extending the Lore Documentation System</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#inputs-and-outputs">Inputs and Outputs</a><ul>
<li><a class="reference internal" href="#creating-new-inputs">Creating New Inputs</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="lore.html"
                                  title="previous chapter">Using the Lore Documentation System</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../examples/index.html"
                                  title="next chapter">Examples</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/lore/howto/extend-lore.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <p>
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                </p>
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    </div>
    <div id="footer"><hr />
      <div>

</div>
      <p class="left2">
        Site design<br />
        By <a href="http://huw.ugbox.net/">huw.wilkins.</a>

      </p>
      <p class="right"></p>
    </div>
    <script type="text/javascript">
      if (window.location.pathname.indexOf('/current/') == -1) {
          <!-- Give the user a link to this page, but in the current version of the docs. -->
          var link = document.getElementById('current-docs-link');
          link.href = window.location.pathname.replace(/\/\d+\.\d+\.\d+/, '/current');
          <!-- And make it visible -->
          var container = document.getElementById('current-docs-container');
          container.style.display = '';
          delete link;
          delete container;
      }
    </script>
  </body>
</html>