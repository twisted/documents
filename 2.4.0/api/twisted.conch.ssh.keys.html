<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>API docs for &ldquo;twisted.conch.ssh.keys&rdquo;</title>
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <h1 class="module">Module t.c.s.keys</h1>
    <p>
      <span id="part">Part of <a href="twisted.conch.ssh.html">twisted.conch.ssh</a></span>
      <a></a>
      <a></a>
    </p>
    <div></div>
    <div><p>Handling of RSA and DSA keys.</p>
<p>This module is unstable.</p>
Maintainer: <a href="mailto:z3p&#64;twistedmatrix.com">Paul 
Swartz</a>
<table class="fieldTable"></table></div>
    
      <table class="children"><tr class="class">
          <td>Class</td>
          <td><a href="twisted.conch.ssh.keys.BadKeyError.html">BadKeyError</a></td>
          <td><span>raised when a key isn't what we expected from it.
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPublicKeyString">getPublicKeyString</a></td>
          <td><span>Return a public key string given a filename or data of a public 
key.
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPublicKeyString_lsh">getPublicKeyString_lsh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPublicKeyString_openssh">getPublicKeyString_openssh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePublicKeyString">makePublicKeyString</a></td>
          <td><span>Return an public key given a 
<code>Crypto.PublicKey.pubkey.pubkey</code>
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePublicKeyString_lsh">makePublicKeyString_lsh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePublicKeyString_openssh">makePublicKeyString_openssh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPublicKeyObject">getPublicKeyObject</a></td>
          <td><span>Return a <code>Crypto.PublicKey.pubkey.pubkey</code> corresponding to 
the SSHv2
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPrivateKeyObject">getPrivateKeyObject</a></td>
          <td><span>Return a <code>Crypto.PublicKey.pubkey.pubkey</code> object 
corresponding to the
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPrivateKeyObject_lsh">getPrivateKeyObject_lsh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPrivateKeyObject_openssh">getPrivateKeyObject_openssh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.getPrivateKeyObject_agentv3">getPrivateKeyObject_agentv3</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePrivateKeyString">makePrivateKeyString</a></td>
          <td><span>Return an OpenSSH-style private key for a
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePrivateKeyString_lsh">makePrivateKeyString_lsh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePrivateKeyString_openssh">makePrivateKeyString_openssh</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePrivateKeyString_agentv3">makePrivateKeyString_agentv3</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePublicKeyBlob">makePublicKeyBlob</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.makePrivateKeyBlob">makePrivateKeyBlob</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.objectType">objectType</a></td>
          <td><span>Return the SSH key type corresponding to a 
<code>Crypto.PublicKey.pubkey.pubkey</code>
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.pkcs1Pad">pkcs1Pad</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.pkcs1Digest">pkcs1Digest</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.lenSig">lenSig</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.signData">signData</a></td>
          <td><span>Sign the data with the given 
<code>Crypto.PublicKey.pubkey.pubkey</code> object.
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.signData_rsa">signData_rsa</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.signData_dsa">signData_dsa</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.verifySignature">verifySignature</a></td>
          <td><span>Verify that the signature for the data is valid.
</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.verifySignature_rsa">verifySignature_rsa</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.verifySignature_dsa">verifySignature_dsa</a></td>
          <td><span class="undocumented">Undocumented</span></td>
        </tr><tr class="function">
          <td>Function</td>
          <td><a href="#twisted.conch.ssh.keys.printKey">printKey</a></td>
          <td><span>Pretty print a <code>Crypto.PublicKey.pubkey.pubkey</code> object.
</span></td>
        </tr></table>
    
    
    <div class="function">
        <a name="twisted.conch.ssh.keys.getPublicKeyString"></a>
        <div class="functionHeader">
          def <span>getPublicKeyString(filename=None, line=0, data=''):</span>
        </div>
        <div class="functionBody"><div>Return a public key string given a filename or data of a public key. 
Currently handles OpenSSH and LSH keys.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">filename</td><td>(type: <code>str</code>
)</td></tr><tr><td></td><td class="fieldArg">line</td><td>(type: <code>int</code>
)</td></tr><tr><td></td><td class="fieldArg">data</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>str</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPublicKeyString_lsh"></a>
        <div class="functionHeader">
          def <span>getPublicKeyString_lsh(data):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPublicKeyString_openssh"></a>
        <div class="functionHeader">
          def <span>getPublicKeyString_openssh(data):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePublicKeyString"></a>
        <div class="functionHeader">
          def <span>makePublicKeyString(obj, comment='', kind='openssh'):</span>
        </div>
        <div class="functionBody"><div>Return an public key given a 
<code>Crypto.PublicKey.pubkey.pubkey</code> object. kind is one of 
('openssh', 'lsh')
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">obj</td><td>(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr><tr><td></td><td class="fieldArg">comment</td><td>(type: <code>str</code>
)</td></tr><tr><td></td><td class="fieldArg">kind</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>str</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePublicKeyString_lsh"></a>
        <div class="functionHeader">
          def <span>makePublicKeyString_lsh(obj):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePublicKeyString_openssh"></a>
        <div class="functionHeader">
          def <span>makePublicKeyString_openssh(obj, comment):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPublicKeyObject"></a>
        <div class="functionHeader">
          def <span>getPublicKeyObject(data):</span>
        </div>
        <div class="functionBody"><div>Return a <code>Crypto.PublicKey.pubkey.pubkey</code> corresponding to 
the SSHv2 public key data. data is in the over-the-wire public key 
format.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">data</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPrivateKeyObject"></a>
        <div class="functionHeader">
          def <span>getPrivateKeyObject(filename=None, data='', passphrase=''):</span>
        </div>
        <div class="functionBody"><div>Return a <code>Crypto.PublicKey.pubkey.pubkey</code> object 
corresponding to the private key file/data. If the private key is 
encrypted, passphrase <b>must</b> be specified, other wise a 
<code>BadKeyError</code> will be raised.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">filename</td><td>(type: <code>str</code>
)</td></tr><tr><td></td><td class="fieldArg">data</td><td>(type: <code>str</code>
)</td></tr><tr><td></td><td class="fieldArg">passphrase</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Raises</td><td class="fieldArg">BadKeyError</td><td>if the key is invalid or a passphrase is not specified
</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPrivateKeyObject_lsh"></a>
        <div class="functionHeader">
          def <span>getPrivateKeyObject_lsh(data, passphrase):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPrivateKeyObject_openssh"></a>
        <div class="functionHeader">
          def <span>getPrivateKeyObject_openssh(data, passphrase):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.getPrivateKeyObject_agentv3"></a>
        <div class="functionHeader">
          def <span>getPrivateKeyObject_agentv3(data, passphrase):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePrivateKeyString"></a>
        <div class="functionHeader">
          def <span>makePrivateKeyString(obj, passphrase=None, kind='openssh'):</span>
        </div>
        <div class="functionBody"><div>Return an OpenSSH-style private key for a 
<code>Crypto.PublicKey.pubkey.pubkey</code> object. If passphrase is 
given, encrypt the private key with it. kind is one of ('openssh', 'lsh', 
'agentv3')
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">obj</td><td>(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr><tr><td></td><td class="fieldArg">passphrase</td><td>(type: <code>str</code>/<code>None</code>
)</td></tr><tr><td></td><td class="fieldArg">kind</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>str</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePrivateKeyString_lsh"></a>
        <div class="functionHeader">
          def <span>makePrivateKeyString_lsh(obj, passphrase):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePrivateKeyString_openssh"></a>
        <div class="functionHeader">
          def <span>makePrivateKeyString_openssh(obj, passphrase):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePrivateKeyString_agentv3"></a>
        <div class="functionHeader">
          def <span>makePrivateKeyString_agentv3(obj, passphrase):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePublicKeyBlob"></a>
        <div class="functionHeader">
          def <span>makePublicKeyBlob(obj):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.makePrivateKeyBlob"></a>
        <div class="functionHeader">
          def <span>makePrivateKeyBlob(obj):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.objectType"></a>
        <div class="functionHeader">
          def <span>objectType(obj):</span>
        </div>
        <div class="functionBody"><div>Return the SSH key type corresponding to a 
<code>Crypto.PublicKey.pubkey.pubkey</code> object.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">obj</td><td>(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>str</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.pkcs1Pad"></a>
        <div class="functionHeader">
          def <span>pkcs1Pad(data, lMod):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.pkcs1Digest"></a>
        <div class="functionHeader">
          def <span>pkcs1Digest(data, lMod):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.lenSig"></a>
        <div class="functionHeader">
          def <span>lenSig(obj):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.signData"></a>
        <div class="functionHeader">
          def <span>signData(obj, data):</span>
        </div>
        <div class="functionBody"><div>Sign the data with the given 
<code>Crypto.PublicKey.pubkey.pubkey</code> object.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">obj</td><td>(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr><tr><td></td><td class="fieldArg">data</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>str</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.signData_rsa"></a>
        <div class="functionHeader">
          def <span>signData_rsa(obj, data):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.signData_dsa"></a>
        <div class="functionHeader">
          def <span>signData_dsa(obj, data):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.verifySignature"></a>
        <div class="functionHeader">
          def <span>verifySignature(obj, sig, data):</span>
        </div>
        <div class="functionBody"><div>Verify that the signature for the data is valid.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">obj</td><td>(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr><tr><td></td><td class="fieldArg">sig</td><td>(type: <code>str</code>
)</td></tr><tr><td></td><td class="fieldArg">data</td><td>(type: <code>str</code>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">(type: <code>bool</code>
)</td></tr></table></div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.verifySignature_rsa"></a>
        <div class="functionHeader">
          def <span>verifySignature_rsa(obj, sig, data):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.verifySignature_dsa"></a>
        <div class="functionHeader">
          def <span>verifySignature_dsa(obj, sig, data):</span>
        </div>
        <div class="functionBody"><div class="undocumented">Undocumented</div></div>
      </div><div class="function">
        <a name="twisted.conch.ssh.keys.printKey"></a>
        <div class="functionHeader">
          def <span>printKey(obj):</span>
        </div>
        <div class="functionBody"><div>Pretty print a <code>Crypto.PublicKey.pubkey.pubkey</code> object.
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">obj</td><td>(type: <code>Crypto.PublicKey.pubkey.pubkey</code>
)</td></tr></table></div></div>
      </div>    
  </body>
</html>