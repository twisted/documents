<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>twisted.internet._sslverify : API documentation</title>

    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link rel="stylesheet" href="bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="apidocs.css" type="text/css" />
  </head>
  <body>

    <nav class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="index.html">
            Twisted API Documentation
          </a>
        </div>
      </div>
    </nav>

   <div id="current-docs-container" class="container" style="display: none">
      <div class="col-sm-12">
        <a id="current-docs-link">
          Go to the latest version of this document.
        </a>
      </div>
    </div>

    <div id="showPrivate">
      <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
    </div>

    <div class="container">

      <div class="page-header">
        <h1 class="module private"><code>twisted.internet._sslverify</code> <small>module documentation</small></h1>

        <span id="partOf">
          Part of <code><a href="twisted.html" data-type="Package" class="code">twisted</a>.<a href="twisted.internet.html" data-type="Package" class="code">internet</a></code>
          <a href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py">View Source</a>
          
        </span>
      </div>

      <div class="extrasDocstring">
        
      </div>

      

      <div class="moduleDocstring">
        <div class="undocumented">No module docstring</div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id593">
  
  <tr class="class">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify.SimpleVerificationError.html" data-type="Class" class="code">SimpleVerificationError</a></td>
    <td><span>Not a very useful verification error.</span></td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#simpleVerifyHostname" data-type="Function" class="code">simpleVerifyHostname</a></td>
    <td><span>Check only the common name in the certificate presented by the peer and 
only for an exact match.</span></td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#simpleVerifyIPAddress" data-type="Function" class="code">simpleVerifyIPAddress</a></td>
    <td><span>Always fails validation of IP addresses</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify.CertBase.html" data-type="Class" class="code">CertBase</a></td>
    <td><span>Base class for public (certificate only) and private (certificate + key 
pair) certificates.</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify.PublicKey.html" data-type="Class" class="code">PublicKey</a></td>
    <td><span>A <a href="twisted.internet._sslverify.PublicKey.html"><code>PublicKey</code></a>
is a representation of the public part of a key pair.</span></td>
  </tr><tr class="interface">
    
    <td>Interface</td>
    <td><a href="twisted.internet._sslverify.IOpenSSLTrustRoot.html" data-type="Interface" class="code">IOpenSSLTrustRoot</a></td>
    <td><span>Trust settings for an OpenSSL context.</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify.OpenSSLCertificateAuthorities.html" data-type="Class" class="code">OpenSSLCertificateAuthorities</a></td>
    <td><span>Trust an explicitly specified set of certificates, represented by a list
of <a href="https://pyopenssl.readthedocs.io/en/stable/api/crypto.html#OpenSSL.crypto.X509"><code>OpenSSL.crypto.X509</code></a>
objects.</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify.ClientTLSOptions.html" data-type="Class" class="code">ClientTLSOptions</a></td>
    <td><span>Client creator for TLS.</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify.OpenSSLCipher.html" data-type="Class" class="code">OpenSSLCipher</a></td>
    <td><span>A representation of an OpenSSL cipher.</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_getExcludedTLSProtocols" data-type="Function" class="code">_getExcludedTLSProtocols</a></td>
    <td><span>Given a pair of <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> 
constants, figure out what versions we want to disable (as OpenSSL is an 
exclusion based API).</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_usablePyOpenSSL" data-type="Function" class="code">_usablePyOpenSSL</a></td>
    <td><span>Check pyOpenSSL version string whether we can use it for host 
verification.</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_selectVerifyImplementation" data-type="Function" class="code">_selectVerifyImplementation</a></td>
    <td><span>Determine if <code>service_identity</code> is installed. If so, use it. 
If not, use simplistic and incorrect checking as implemented in <a href="twisted.internet._sslverify.html#simpleVerifyHostname"><code>simpleVerifyHostname</code></a>.</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_handleattrhelper" data-type="Function" class="code">_handleattrhelper</a></td>
    <td><span class="undocumented">No summary</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_tolerateErrors" data-type="Function" class="code">_tolerateErrors</a></td>
    <td><span>Wrap up an <code>info_callback</code> for pyOpenSSL so that if something
goes wrong the error is immediately logged and the connection is dropped if
possible.</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_expandCipherString" data-type="Function" class="code">_expandCipherString</a></td>
    <td><span>Expand <code>cipherString</code> according to <code>method</code> and 
<code>options</code> to a list of explicit ciphers that are supported by 
the current platform.</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><a href="twisted.internet._sslverify._ChooseDiffieHellmanEllipticCurve.html" data-type="Class" class="code">_ChooseDiffieHellmanEllipticCurve</a></td>
    <td><span>Chooses the best elliptic curve for Elliptic Curve Diffie-Hellman key 
exchange, and provides a <code>configureECDHCurve</code> method to set the 
curve, when appropriate, on a new <a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context"><code>OpenSSL.SSL.Context</code></a>.</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><a href="twisted.internet._sslverify.html#_setAcceptableProtocols" data-type="Function" class="code">_setAcceptableProtocols</a></td>
    <td><span>Called to set up the <a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context"><code>OpenSSL.SSL.Context</code></a>
for doing NPN and/or ALPN negotiation.</span></td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basefunction private">
  
  <a name="twisted.internet._sslverify._getExcludedTLSProtocols">
    
  </a>
  <a name="_getExcludedTLSProtocols">
    
  </a>
  <div class="functionHeader">
    
    def
    _getExcludedTLSProtocols(oldest, newest):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L69">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Given a pair of <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> 
constants, figure out what versions we want to disable (as OpenSSL is an 
exclusion based API).</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">oldest</td><td>The oldest <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> we 
want to allow. (type: <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> 
constant)</td></tr><tr><td></td><td class="fieldArg">newest</td><td>The newest <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> we 
want to allow, or <a href="http://docs.python.org/library/constants.html#None"><code>None</code></a>
for no upper limit. (type: <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> 
constant or <a href="http://docs.python.org/library/constants.html#None"><code>None</code></a>)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">The versions we want to disable. (type: <a href="http://docs.python.org/library/stdtypes.html#list"><code>list</code></a>
of <a href="twisted.internet.ssl.TLSVersion.html"><code>TLSVersion</code></a> 
constants.)</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  <a name="twisted.internet._sslverify.simpleVerifyHostname">
    
  </a>
  <a name="simpleVerifyHostname">
    
  </a>
  <div class="functionHeader">
    
    def
    simpleVerifyHostname(connection, hostname):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L102">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Check only the common name in the certificate presented by the peer and 
only for an exact match.</p>
<p>This is to provide <i>something</i> in the way of hostname verification 
to users who haven't installed <code>service_identity</code>. This check is
overly strict, relies on a deprecated TLS feature (you're supposed to 
ignore the commonName if the subjectAlternativeName extensions are present,
I believe), and lots of valid certificates will fail.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">connection</td><td>the OpenSSL connection to verify. (type: <a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Connection"><code>OpenSSL.SSL.Connection</code></a>)</td></tr><tr><td></td><td class="fieldArg">hostname</td><td>The hostname expected by the user. (type: <a href="twisted.python.compat.html#unicode"><code>unicode</code></a>)</td></tr><tr class="fieldStart"><td class="fieldName">Raises</td><td class="fieldArg">twisted.internet.ssl.VerificationError</td><td>if the common name and hostname don't match.</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  <a name="twisted.internet._sslverify.simpleVerifyIPAddress">
    
  </a>
  <a name="simpleVerifyIPAddress">
    
  </a>
  <div class="functionHeader">
    
    def
    simpleVerifyIPAddress(connection, hostname):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L129">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Always fails validation of IP addresses</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">connection</td><td>the OpenSSL connection to verify. (type: <a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Connection"><code>OpenSSL.SSL.Connection</code></a>)</td></tr><tr><td></td><td class="fieldArg">hostname</td><td>The hostname expected by the user. (type: <a href="twisted.python.compat.html#unicode"><code>unicode</code></a>)</td></tr><tr class="fieldStart"><td class="fieldName">Raises</td><td class="fieldArg">twisted.internet.ssl.VerificationError</td><td>Always raised</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  <a name="twisted.internet._sslverify._usablePyOpenSSL">
    
  </a>
  <a name="_usablePyOpenSSL">
    
  </a>
  <div class="functionHeader">
    
    def
    _usablePyOpenSSL(version):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L145">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Check pyOpenSSL version string whether we can use it for host 
verification.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">version</td><td>A pyOpenSSL version string. (type: <a href="http://docs.python.org/library/stdtypes.html#str"><code>str</code></a>)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2"> (type: <a href="http://docs.python.org/library/stdtypes.html#bool"><code>bool</code></a>)</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  <a name="twisted.internet._sslverify._selectVerifyImplementation">
    
  </a>
  <a name="_selectVerifyImplementation">
    
  </a>
  <div class="functionHeader">
    
    def
    _selectVerifyImplementation():
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L159">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Determine if <code>service_identity</code> is installed. If so, use it. 
If not, use simplistic and incorrect checking as implemented in <a href="twisted.internet._sslverify.html#simpleVerifyHostname"><code>simpleVerifyHostname</code></a>.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">2-tuple of (<code>verify_hostname</code>, <code>VerificationError</code>) (type: <a href="http://docs.python.org/library/stdtypes.html#tuple"><code>tuple</code></a>)</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  <a name="twisted.internet._sslverify._handleattrhelper">
    
  </a>
  <a name="_handleattrhelper">
    
  </a>
  <div class="functionHeader">
    
    def
    _handleattrhelper(Class, transport, methodName):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L430">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>(private) Helper for <a href="twisted.internet.ssl.Certificate.html#peerFromTransport"><code>Certificate.peerFromTransport</code></a>
and <a href="twisted.internet.ssl.Certificate.html#hostFromTransport"><code>Certificate.hostFromTransport</code></a>
which checks for incompatible handle types and null certificates and raises
the appropriate exception or returns the appropriate certificate 
object.</p><table class="fieldTable"></table></div>
  </div>
</div><div class="basefunction private">
  
  <a name="twisted.internet._sslverify._tolerateErrors">
    
  </a>
  <a name="_tolerateErrors">
    
  </a>
  <div class="functionHeader">
    
    def
    _tolerateErrors(wrapped):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L1092">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Wrap up an <code>info_callback</code> for pyOpenSSL so that if something
goes wrong the error is immediately logged and the connection is dropped if
possible.</p>
<p>This wrapper exists because some versions of pyOpenSSL don't handle 
errors from callbacks at <i>all</i>, and those which do write tracebacks 
directly to stderr rather than to a supplied logging system.  This reports 
unexpected errors to the Twisted logging system.</p>
<p>Also, this terminates the connection immediately if possible because if 
you've got bugs in your verification logic it's much safer to just give 
up.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">wrapped</td><td>A valid <code>info_callback</code> for pyOpenSSL. (type: <a href="http://docs.python.org/library/functions.html#callable"><code>callable</code></a>)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">A valid <code>info_callback</code> for pyOpenSSL that handles any errors in
<code>wrapped</code>. (type: <a href="http://docs.python.org/library/functions.html#callable"><code>callable</code></a>)</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  <a name="twisted.internet._sslverify._expandCipherString">
    
  </a>
  <a name="_expandCipherString">
    
  </a>
  <div class="functionHeader">
    
    def
    _expandCipherString(cipherString, method, options):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L1766">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Expand <code>cipherString</code> according to <code>method</code> and 
<code>options</code> to a list of explicit ciphers that are supported by 
the current platform.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">cipherString</td><td>An OpenSSL cipher string to expand. (type: <a href="twisted.python.compat.html#unicode"><code>unicode</code></a>)</td></tr><tr><td></td><td class="fieldArg">method</td><td>An OpenSSL method like <code>SSL.TLSv1_METHOD</code> used for determining 
the effective ciphers.</td></tr><tr><td></td><td class="fieldArg">options</td><td>OpenSSL options like <code>SSL.OP_NO_SSLv3</code> ORed together. (type: <a href="http://docs.python.org/library/stdtypes.html#int"><code>int</code></a>)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">The effective list of explicit ciphers that results from the arguments on 
the current platform. (type: <a href="http://docs.python.org/library/stdtypes.html#list"><code>list</code></a>
of <a href="twisted.internet.interfaces.ICipher.html"><code>ICipher</code></a>)</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  <a name="twisted.internet._sslverify._setAcceptableProtocols">
    
  </a>
  <a name="_setAcceptableProtocols">
    
  </a>
  <div class="functionHeader">
    
    def
    _setAcceptableProtocols(context, acceptableProtocols):
    <a class="functionSourceLink" href="https://github.com/twisted/twisted/tree/twisted-19.2.1/src/twisted/internet/_sslverify.py#L2003">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Called to set up the <a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context"><code>OpenSSL.SSL.Context</code></a>
for doing NPN and/or ALPN negotiation.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">context</td><td>The context which is set up. (type: <a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context"><code>OpenSSL.SSL.Context</code></a>)</td></tr><tr><td></td><td class="fieldArg">acceptableProtocols</td><td>The protocols this peer is willing to speak after the TLS negotiation has 
completed, advertised over both ALPN and NPN. If this argument is 
specified, and no overlap can be found with the other peer, the connection 
will fail to be established. If the remote peer does not offer NPN or ALPN,
the connection will be established, but no protocol wil be negotiated. 
Protocols earlier in the list are preferred over those later in the list. (type: <a href="http://docs.python.org/library/stdtypes.html#list"><code>list</code></a>
of <a href="http://docs.python.org/library/stdtypes.html#bytes"><code>bytes</code></a>)</td></tr></table></div>
  </div>
</div>

      </div>
      <address>
        <a href="index.html">API Documentation</a> for <a href="http://twistedmatrix.com/">Twisted</a>, generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a> at 2019-06-07 00:11:44.
      </address>

    </div>

    <script type="text/javascript" src="pydoctor.js"></script>

    <!-- Google analytics, obviously. -->
    <script type="text/javascript" src="//www.google-analytics.com/urchin.js"></script>
    <script type="text/javascript">
      _uacct = "UA-99018-6";
      urchinTracker();
    </script>

    <!-- If the documentation isn't current, insert a current link. -->
    <script type="text/javascript">
      if (window.location.pathname.indexOf('/current/') == -1) {
        <!-- Give the user a link to this page, but in the current version of the docs. -->
        var link = document.getElementById('current-docs-link');
        link.href = window.location.pathname.replace(/\/\d+\.\d+\.\d+\/api\//, '/current/api/');
        <!-- And make it visible -->
        var container = document.getElementById('current-docs-container');
        container.style.display = "";
        delete link;
        delete container;
      }
    </script>

  </body>
</html>