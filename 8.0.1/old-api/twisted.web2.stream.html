<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>API docs for &ldquo;twisted.web2.stream&rdquo;</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    
    
  </head>
  <body>
    <h1 class="module">Module t.w.stream</h1>
    <p>
      <span id="part">Part of <a href="twisted.html">twisted</a>.<a href="twisted.web2.html">web2</a></span>
      <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py">View Source</a>
      
    </p>
    <div>
      
    </div>
    <div><p>The stream module provides a simple abstraction of streaming data. 
While Twisted already has some provisions for handling this in its 
Producer/Consumer model, the rather complex interactions between producer 
and consumer makes it difficult to implement something like the 
CompoundStream object. Thus, this API.</p>
<p>The IStream interface is very simple. It consists of two methods: 
read, and close. The read method should either return some data, None if 
there is no data left to read, or a Deferred. Close frees up any 
underlying resources and causes read to return None forevermore.</p>
<p>IByteStream adds a bit more to the API: 1) read is required to return 
objects conforming to the buffer interface. 2) .length, which may either 
an integer number of bytes remaining, or None if unknown 3) 
.split(position). Split takes a position, and splits the stream in two 
pieces, returning the two new streams. Using the original stream after 
calling split is not allowed.</p>
There are two builtin source stream classes: FileStream and 
MemoryStream. The first produces data from a file object, the second from 
a buffer in memory. Any number of these can be combined into one stream 
with the CompoundStream object. Then, to interface with other parts of 
Twisted, there are two transcievers: StreamProducer and ProducerStream. 
The first takes a stream and turns it into an IPushProducer, which will 
write to a consumer. The second is a consumer which is a stream, so that 
other producers can write to it.
<table class="fieldTable"></table></div>
    
    
    <div id="splitTables">
      <table class="children sortable" id="id1675">
  
  
  
  
  <tr class="interface">
    
    
    <td>Interface</td>
    <td><a href="twisted.web2.stream.IStream.html">IStream</a></td>
    <td><span>A stream of arbitrary data.
</span></td>
  </tr><tr class="interface">
    
    
    <td>Interface</td>
    <td><a href="twisted.web2.stream.IByteStream.html">IByteStream</a></td>
    <td><span>A stream which is of bytes.
</span></td>
  </tr><tr class="interface">
    
    
    <td>Interface</td>
    <td><a href="twisted.web2.stream.ISendfileableStream.html">ISendfileableStream</a></td>
    <td><span class="undocumented">No interface docstring; 1/1 methods documented</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.SimpleStream.html">SimpleStream</a></td>
    <td><span>Superclass of simple streams with a single buffer and a offset and 
length
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#mmapwrapper">mmapwrapper</a></td>
    <td><span>Python's mmap call sucks and ommitted the &quot;offset&quot; argument 
for no
</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.FileStream.html">FileStream</a></td>
    <td><span class="undocumented">No class docstring; 1/3 methods documented</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.MemoryStream.html">MemoryStream</a></td>
    <td><span>A stream that reads data from a buffer object.
</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.CompoundStream.html">CompoundStream</a></td>
    <td><span>A stream which is composed of many other streams.
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#readStream">readStream</a></td>
    <td><span>Pass a stream's data to a callback.
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#readAndDiscard">readAndDiscard</a></td>
    <td><span>Read all the data from the given stream, and throw it out.
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#readIntoFile">readIntoFile</a></td>
    <td><span>Read a stream and write it into a file.
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#connectStream">connectStream</a></td>
    <td><span>Connect a protocol constructed from a factory to stream.
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#fallbackSplit">fallbackSplit</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.TruncaterStream.html">TruncaterStream</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.PostTruncaterStream.html">PostTruncaterStream</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.ProducerStream.html">ProducerStream</a></td>
    <td><span>Turns producers into a IByteStream.
</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.StreamProducer.html">StreamProducer</a></td>
    <td><span>A push producer which gets its data by reading a stream.
</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.ProcessStreamer.html">ProcessStreamer</a></td>
    <td><span>Runs a process hooked up to streams.
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#generatorToStream">generatorToStream</a></td>
    <td><span>Converts a generator function into a stream.
</span></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream.BufferedStream.html">BufferedStream</a></td>
    <td><span>A stream which buffers its data to provide operations like
</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="twisted.web2.stream.html#substream">substream</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream._StreamReader.html">_StreamReader</a></td>
    <td><span>Process a stream's data using callbacks for data and stream 
finish.
</span></td>
  </tr><tr class="class private">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream._ProcessStreamerProtocol.html">_ProcessStreamerProtocol</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream._StreamIterator.html">_StreamIterator</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    
    <td>Class</td>
    <td><a href="twisted.web2.stream._IteratorStream.html">_IteratorStream</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    
    <div class="function">
        <a name="twisted.web2.stream.mmapwrapper"></a>
        <a name="mmapwrapper"></a>
        <div class="functionHeader">
        
        def mmapwrapper(*args, **kwargs):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L152" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div>Python's mmap call sucks and ommitted the &quot;offset&quot; argument 
for no discernable reason. Replace this with a mmap module that has 
offset.
<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.readStream"></a>
        <a name="readStream"></a>
        <div class="functionHeader">
        
        def readStream(stream, gotDataCallback):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L427" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div><p>Pass a stream's data to a callback.</p>
Returns Deferred which will be triggered on finish. Errors in reading 
the stream or in processing it will be returned via this Deferred.
<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.readAndDiscard"></a>
        <a name="readAndDiscard"></a>
        <div class="functionHeader">
        
        def readAndDiscard(stream):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L437" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div><p>Read all the data from the given stream, and throw it out.</p>
Returns Deferred which will be triggered on finish.
<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.readIntoFile"></a>
        <a name="readIntoFile"></a>
        <div class="functionHeader">
        
        def readIntoFile(stream, outFile):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L444" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div><p>Read a stream and write it into a file.</p>
Returns Deferred which will be triggered on finish.
<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.connectStream"></a>
        <a name="connectStream"></a>
        <div class="functionHeader">
        
        def connectStream(inputStream, factory):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L454" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div><p>Connect a protocol constructed from a factory to stream.</p>
<p>Returns an output stream from the protocol.</p>
The protocol's transport will have a finish() method it should call 
when done writing.
<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.fallbackSplit"></a>
        <a name="fallbackSplit"></a>
        <div class="functionHeader">
        
        def fallbackSplit(stream, point):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L475" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div class="undocumented">Undocumented</div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.generatorToStream"></a>
        <a name="generatorToStream"></a>
        <div class="functionHeader">
        
        def generatorToStream(fun):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L910" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div><p>Converts a generator function into a stream.</p>
<p>The function should take an iterator as its first argument, which will 
be converted *from* a stream by this wrapper, and yield items which are 
turned *into* the results from the stream's 'read' call.</p>
One important point: before every call to input.next(), you *MUST* do 
a &quot;yield input.wait&quot; first. Yielding this magic value takes 
care of ensuring that the input is not a deferred before you see it.
<pre class="doctestblock">
<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> twisted.web2 <span class="py-keyword">import</span> stream
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> string <span class="py-keyword">import</span> maketrans
<span class="py-prompt">&gt;&gt;&gt; </span>alphabet = <span class="py-string">'abcdefghijklmnopqrstuvwxyz'</span>
<span class="py-prompt">&gt;&gt;&gt;
</span><span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">def</span> encrypt(input, key):
<span class="py-prompt">... </span>    code = alphabet[key:] + alphabet[:key]
<span class="py-prompt">... </span>    translator = maketrans(alphabet+alphabet.upper(), code+code.upper())
<span class="py-prompt">... </span>    yield input.wait
<span class="py-prompt">... </span>    <span class="py-keyword">for</span> s <span class="py-keyword">in</span> input:
<span class="py-prompt">... </span>        yield str(s).translate(translator)
<span class="py-prompt">... </span>        yield input.wait
<span class="py-prompt">...
</span><span class="py-prompt">&gt;&gt;&gt; </span>encrypt = stream.generatorToStream(encrypt)
<span class="py-prompt">&gt;&gt;&gt;
</span><span class="py-prompt">&gt;&gt;&gt; </span>plaintextStream = stream.MemoryStream(<span class="py-string">'SampleSampleSample'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>encryptedStream = encrypt(plaintextStream, 13)
<span class="py-prompt">&gt;&gt;&gt; </span>encryptedStream.read()</span>
<span class="py-output">'FnzcyrFnzcyrFnzcyr'</span>

<span class="py-src"><span class="py-prompt">&gt;&gt;&gt;
</span><span class="py-prompt">&gt;&gt;&gt; </span>plaintextStream = stream.MemoryStream(<span class="py-string">'SampleSampleSample'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>encryptedStream = encrypt(plaintextStream, 13)
<span class="py-prompt">&gt;&gt;&gt; </span>evenMoreEncryptedStream = encrypt(encryptedStream, 13)
<span class="py-prompt">&gt;&gt;&gt; </span>evenMoreEncryptedStream.read()</span>
<span class="py-output">'SampleSampleSample'</span></pre>
<table class="fieldTable"></table></div>
        </div>
      </div><div class="function">
        <a name="twisted.web2.stream.substream"></a>
        <a name="substream"></a>
        <div class="functionHeader">
        
        def substream(stream, start, end):
        <a href="http://twistedmatrix.com/trac/browser/tags/releases/twisted-8.0.1/twisted/web2/stream.py#L1070" class="functionSourceLink">
        
        (source)
      </a>
      </div>
        <div class="functionBody">
          
          <div class="undocumented">Undocumented</div>
        </div>
      </div>
    
    <address>
      <a href="index.html">API Documentation</a> for <a href="http://twistedmatrix.com/trac">Twisted</a>, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2008-05-18 16:42:17.
    </address>
  </body>
</html>